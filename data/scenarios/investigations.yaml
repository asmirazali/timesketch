# ------------------------------------------------------------------------
#                       -- Investigations --
# ------------------------------------------------------------------------
#
# This is a config file to define investigations that.
#
# Each investigation consists of the following fields:
#
#                       -- metadata --
#       display_name        Simple string that contains the display name that
#                           be used in an UI to describe the question.
#
#       description         Further description of the question, what the
#                           question attempts to answer, whether it will
#                           require further manual analysis, etc.
#
# ------------------------------------------------------------------------
test_investigation:
  display_name: Lorem Ipsum investigation
  description: Lorem ipsum dolor sit amet, consectetur adipiscing elit.
  questions:
    - user_logged_in_win
    - user_downloaded_file

another_investigation:
  display_name: Lorem Ipsum investigation
  description: Lorem ipsum dolor sit amet, consectetur adipiscing elit.
  questions:
    - user_logged_in_win

get_windows_system_info:
  display_namr: Get various system info
  description: Get various information about a windows machine
  questions:
    - windows_operating_system
    - windows_current_control_set
    - windows_local_time

get_windows_execution:
  disaply: What was executed around a certain time range
  description: Query various sources to find what might be executed around a before and after a timestamp
  questions:
    - windows_prefetch_execution

windows_persistence:
  display: What events could be targeted to get persistence
  description: Lorem Ipsum
  question:
    - windows_installed_services

sensitive_files:
  display: Highlight sensitive file extension that are commonly used in exfil activity.
  questions:
    - sensitive_files

initial_access:
  display: Any attempts to have initial access to a system?
  questions:
    - initial_access

gcp_investigation:
  display: Check various points that point to a compromised Google Cloud Project.
  description: Based on various logs Based on: https://github.com/SigmaHQ/sigma/tree/master/rules/cloud/gcp
  questions:
    - gcp_bucket_enumeration
    - gcp_bucket_modified_or_deleted
    - gcp_dlp_re-identifies_sensitive_information
    - gcp_dns_zone_modified_or_deleted
    - gcp_firewall_rule_modified_or_deleted
    - gcp_full_network_traffic_packet_capture
    - gcp_kubernetes_secrets_modified_or_deleted
    - gcp_service_account_disabled_or_deleted
    - gcp_service_account_modified
    - gcp_vpn_tunnel_modified_or_deleted
